# Liturgical Calendar
A PHP script that will generate the liturgical calendar for any given year, based on the General Roman Calendar, calculating the mobile festivities and the precedence of solemnities, feasts, memorials... This script serves as a data endpoint, which will generate the data for the General Roman Calendar in a data exchange format, such as JSON, XML, or ICS. An example of the endpoint can be found at https://johnromanodorazio.com/LiturgicalCalendar/, at the first link on the page [*data generation endpoint here*](https://johnromanodorazio.com/LiturgicalCalendar/LitCalEngine.php).

Some characteristics of this endpoint:
* The data is based on official sources, not copied from random internet sources. Sources used are the various editions of the **Roman Missal** in Latin, English, and Italian, **Magisterial documents**, and the **Decrees of the Congregation for Divine Worship**
    - Missale Romanum, Editio typica, 1970
    - Missale Romanum, Reimpressio emendata, 1971
    - Missale Romanum, Editio typica secunda, 1975
    - Missale Romanum, Editio typica tertia, 2002
    - Missale Romanum, Editio typica tertia emendata, 2008
    - [Mysterii Paschalis, PAULUS PP. VI, 1969](http://www.vatican.va/content/paul-vi/la/motu_proprio/documents/hf_p-vi_motu-proprio_19690214_mysterii-paschalis.html)
    - [Decrees of the Congregation of Divine Worship](https://www.vatican.va/roman_curia/congregations/ccdds/index_it.htm)
* The data is historically accurate, *i.e.* the liturgical calendar produced for the year 1979 will reflect the calendar as it was in that year, and not as it would be today (obviously future years will reflect the calendar as it is generated in the current year; as new decrees are issued by the Congregation for Divine Worship or new editions of the Roman Missal are published, the script will need to be updated to account for any new criteria)


# How to setup the endpoint yourself
1. **Setup the database tables**
  Included is an SQL dump **liturgy.sql** which contains database tables with fixed date festivities, memorials and optional memorials of the General Roman Calendar. The PHP script aids itself with these tables to generate the liturgical calendar along with the localized translations of the festivities. The tables themselved do not necessarily define the dates of all festivities, for example movable feasts are necessarily are calculated in the script itself, in this case the tables server only for localization purposes.
2. **Edit the configuration file for access to the database**
  Once the tables are set up in a database, the `LitCalConfig-sample.php` file must be renamed to `LitCalConfig.php` and populated with the credentials to access the database. Seeing that this file will be renamed for production, it will not be overwritten when the scripts get updated from a new release or a `git pull`.

# How to use the endpoint
There are two examples of usage of the endpoint at https://johnromanodorazio.com/LiturgicalCalendar/, in this case for generating an HTML representation of the Liturgical Calendar.

* The [https://johnromanodorazio.com/LiturgicalCalendar/examples/javascript_liturgical_calendar.php first example] uses AJAX in Javascript to make the request to the endpoint and handle the results. 
* The [https://johnromanodorazio.com/LiturgicalCalendar/examples/curl_liturgical_calendar.php second example] uses cURL in PHP to make a request to the endpoint and handle the results. 

Both of these examples request JSON as the data exchange format generated by the endpoint. But any application could use the endpoint in a similar manner: an Android App, a plugin for a Desktop Publishing App...

## Parameters that can be used in the request to the endpoint
* ***locale***: can have a value of *EN*, *IT*, or *LA* (*default*: *LA*). Sets the desired localization for the Calendar to *English*, *Italian*, or *Latin* respectively.
* ***year***: can have a value starting from *1970* and a maximum value of *9999* (*default*: current year). For the time being, this endpoint only calculates the Liturgical Calendar that follows the reform of the Second Vatican Council, starting from the publishing of the *Editio Typica* of the Roman Missal in 1970. Perhaps in future updates information from the calendar preceding the Second Vatican Council will be added, in order to have a greater historical range from the endpoint.
* ***returntype***: can have a value of *JSON*, *XML*, or *ICS* (*default*: *JSON*). Indicates the format of the data that will be returned by the endpoint.
* ***epiphany***: can have a value of *SUNDAY_JAN2_JAN8* or *JAN6* (*default*: *JAN6*). Indicates whether Epiphany should fall exactly on January 6th or instead on the Sunday between January 2nd and January 8th. Traditionally it falls on January 6th in the Vatican, but each Episcopal Conference of Bishops can opt to celebrate on the Sunday.
* ***ascension***: can have a value of *THURSDAY* or *SUNDAY* (*default*: *SUNDAY*). Indicates whether the feast of the Ascension should fall on a Thursday or on a Sunday. Traditionally in the Vatican it falls on a Thursday, but for pastoral reasons each Episcopal Conference of Bishops can opt to celebrate on Sunday.
* ***corpuschristi***: can have a value of *THURSDAY* or *SUNDAY* (*default*: *SUNDAY*). Indicates whether the feast of Corpus Christi should fall on a Thursday or on a Sunday. Traditionally in the Vatican it falls on a Thursday, but for pastoral reasons each Episcopal Conference of Bishops can opt to celebrate on Sunday.

**N.B.** The parameter names are expected to be in lowercase characters. The parameter values are generally expected to be in uppercase characters, but they will work in lowercase characters just as well (starting from v2.5).

A sample request to the endpoint could look like this:

https://johnromanodorazio.com/LiturgicalCalendar/LitCalEngine.php?year=2020&epiphany=SUNDAY_JAN2_JAN8&ascension=SUNDAY&corpuschristi=SUNDAY&returntype=JSON&locale=EN

If no parameters are given, the default values indicated above will be used.

Both **POST** and **GET** requests can be made.

# CHANGELOG

## [v2.5](https://github.com/JohnRDOrazio/LiturgicalCalendar/releases/tag/v2.5) (July 25th 2020)
 * make sure all endpoint parameters can have values with either uppercase or lowercase characters
 * fix a few small issues with the ICS data generation

## [v2.4](https://github.com/JohnRDOrazio/LiturgicalCalendar/releases/tag/v2.4) (July 24th 2020)
 * move as many festivities as possible to the MySQL tables to allow for localization (mobile feasts will be calculated in the script, but still need to be localized)
 * add ICS data generation (requires more localization strings, because it is already a form of final display of the data)

## [v2.0](https://github.com/JohnRDOrazio/LiturgicalCalendar/releases/tag/1.0) (January 8th 2018)
 * separate the display logic from the engine, so that the engine can act as an endpoint
 * make the engine return JSON or XML data that the display logic can use to generate a user-friendly representation of the data

## [v1.0](https://github.com/JohnRDOrazio/LiturgicalCalendar/releases/tag/1.0) (July 26th 2017)
 * proof of concept for the correct generation of a liturgical calendar
 * create MySQL table for the Proper of the Saints
